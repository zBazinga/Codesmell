Class:RelStructuredTypeFlattener
Field:relBuilder
Field:rexBuilder
Field:restructure
Field:oldToNewRelMap
Field:currentRel
Field:iRestructureInput
Field:flattenedRootType
Field:restructured
Field:toRelContext
Method-name:RelStructuredTypeFlattener
Method-returnType:null
Method-parameters:[RexBuilder rexBuilder, RelOptTable.ToRelContext toRelContext, boolean restructure]
MethodInvocation:create
MethodInvocation:getCluster
Method-name:RelStructuredTypeFlattener
Method-returnType:null
Method-parameters:[RelBuilder relBuilder, RexBuilder rexBuilder, RelOptTable.ToRelContext toRelContext, boolean restructure]
FieldAccess:relBuilder
FieldAccess:rexBuilder
FieldAccess:toRelContext
FieldAccess:restructure
Method-name:updateRelInMap
Method-returnType:void
Method-parameters:[SortedSetMultimap<RelNode,CorrelationId> mapRefRelToCorVar]
MethodInvocation:newArrayList
MethodInvocation:keySet
MethodInvocation:containsKey
MethodInvocation:removeAll
MethodInvocation:putAll
MethodInvocation:get
Method-name:updateRelInMap
Method-returnType:void
Method-parameters:[SortedMap<CorrelationId,LogicalCorrelate> mapCorVarToCorRel]
Method-name:rewrite
Method-returnType:RelNode
Method-parameters:[RelNode root]
MethodInvocation:visit
MethodInvocation:getNewForOldRel
MethodInvocation:getRowType
MethodInvocation:tryRestructure
Method-name:tryRestructure
Method-returnType:RelNode
Method-parameters:[RelNode root, RelNode flattened]
MethodInvocation:restructureFields
MethodInvocation:getRowType
MethodInvocation:getFieldNames
MethodInvocation:getRowType
MethodInvocation:build
MethodInvocation:projectNamed
MethodInvocation:push
MethodInvocation:copyRelHints
Method-name:restructureFields
Method-returnType:List<RexNode>
Method-parameters:[RelDataType structuredType]
MethodInvocation:getFieldList
MethodInvocation:getType
MethodInvocation:isStruct
MethodInvocation:restructure
MethodInvocation:add
Method-name:restructure
Method-returnType:RexNode
Method-parameters:[RelDataType structuredType]
MethodInvocation:restructureFields
MethodInvocation:makeCall
Method-name:setNewForOldRel
Method-returnType:void
Method-parameters:[RelNode oldRel, RelNode newRel]
MethodInvocation:put
Method-name:getNewForOldRel
Method-returnType:RelNode
Method-parameters:[RelNode oldRel]
MethodInvocation:get
Method-name:getNewForOldInput
Method-returnType:int
Method-parameters:[int oldOrdinal]
FieldAccess:i
MethodInvocation:getNewFieldForOldInput
Method-name:getNewFieldForOldInput
Method-returnType:Ord<RelDataType>
Method-parameters:[int oldOrdinal, int innerOrdinal]
Method-name:getNewInputFieldByNewOrdinal
Method-returnType:RelDataTypeField
Method-parameters:[int newOrdinal]
MethodInvocation:orElseThrow
MethodInvocation:findFirst
MethodInvocation:skip
MethodInvocation:flatMap
MethodInvocation:map
MethodInvocation:stream
MethodInvocation:getInputs
MethodInvocation:stream
MethodInvocation:getFieldList
MethodInvocation:getRowType
Method-name:noFlatteningForInput
Method-returnType:boolean
Method-parameters:[int fieldIdx]
MethodInvocation:getInputs
MethodInvocation:getFieldCount
MethodInvocation:getRowType
MethodInvocation:size
MethodInvocation:getFieldList
MethodInvocation:getRowType
MethodInvocation:getNewForOldRel
MethodInvocation:size
MethodInvocation:getFieldList
MethodInvocation:getRowType
Method-name:getNewFieldForOldInput
Method-returnType:Ord<RelDataType>
Method-parameters:[int oldOrdinal]
MethodInvocation:getNewFieldForOldInput
Method-name:getNewForOldInputMapping
Method-returnType:Mappings.TargetMapping
Method-parameters:[RelNode oldRel]
MethodInvocation:getNewForOldRel
MethodInvocation:target
MethodInvocation:getFieldCount
MethodInvocation:getRowType
MethodInvocation:getFieldCount
MethodInvocation:getRowType
Method-name:getPostFlatteningOrdinal
Method-returnType:int
Method-parameters:[RelDataType preFlattenRowType, int preFlattenOrdinal]
MethodInvocation:sum
MethodInvocation:mapToInt
MethodInvocation:map
MethodInvocation:limit
MethodInvocation:stream
MethodInvocation:getFieldList
Method-name:postFlattenSize
Method-returnType:int
Method-parameters:[RelDataType type]
MethodInvocation:isStruct
MethodInvocation:sum
MethodInvocation:mapToInt
MethodInvocation:map
MethodInvocation:stream
MethodInvocation:getFieldList
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[LogicalTableModify rel]
MethodInvocation:create
MethodInvocation:getTable
MethodInvocation:getCatalogReader
MethodInvocation:getNewForOldRel
MethodInvocation:getInput
MethodInvocation:getOperation
MethodInvocation:getUpdateColumnList
MethodInvocation:getSourceExpressionList
MethodInvocation:setNewForOldRel
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[LogicalAggregate rel]
MethodInvocation:getInput
MethodInvocation:getRowType
MethodInvocation:getFieldList
MethodInvocation:isFlat
MethodInvocation:allMatch
MethodInvocation:stream
MethodInvocation:getAggCallList
MethodInvocation:isEmpty
MethodInvocation:getArgList
MethodInvocation:noneMatch
MethodInvocation:stream
MethodInvocation:getArgList
MethodInvocation:isStruct
MethodInvocation:getType
MethodInvocation:get
MethodInvocation:rewriteGeneric
MethodInvocation:tryRestructure
MethodInvocation:getNewForOldRel
MethodInvocation:copy
MethodInvocation:getTraitSet
MethodInvocation:getGroupSet
MethodInvocation:getGroupSets
MethodInvocation:getAggCallList
MethodInvocation:isFlat
MethodInvocation:getRowType
MethodInvocation:coverNewRelByFlatteningProjection
MethodInvocation:setNewForOldRel
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[Sort rel]
MethodInvocation:getCollation
MethodInvocation:getInput
MethodInvocation:getNewForOldRel
MethodInvocation:getNewForOldInputMapping
MethodInvocation:getFieldCollations
MethodInvocation:getFieldIndex
MethodInvocation:getType
MethodInvocation:get
MethodInvocation:getFieldList
MethodInvocation:getRowType
MethodInvocation:isStruct
MethodInvocation:needToImplement
MethodInvocation:apply
MethodInvocation:create
MethodInvocation:setNewForOldRel
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[LogicalFilter rel]
MethodInvocation:getTraitSet
MethodInvocation:getCondition
MethodInvocation:getNewForOldRel
MethodInvocation:getInput
MethodInvocation:accept
MethodInvocation:copy
MethodInvocation:setNewForOldRel
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[LogicalJoin rel]
MethodInvocation:create
MethodInvocation:getNewForOldRel
MethodInvocation:getLeft
MethodInvocation:getNewForOldRel
MethodInvocation:getRight
MethodInvocation:getHints
MethodInvocation:accept
MethodInvocation:getCondition
MethodInvocation:getVariablesSet
MethodInvocation:getJoinType
MethodInvocation:setNewForOldRel
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[LogicalCorrelate rel]
MethodInvocation:builder
MethodInvocation:getRequiredColumns
MethodInvocation:getType
MethodInvocation:get
MethodInvocation:getFieldList
MethodInvocation:getRowType
MethodInvocation:getLeft
MethodInvocation:isStruct
MethodInvocation:needToImplement
MethodInvocation:set
MethodInvocation:getNewForOldInput
MethodInvocation:create
MethodInvocation:getNewForOldRel
MethodInvocation:getLeft
MethodInvocation:getNewForOldRel
MethodInvocation:getRight
MethodInvocation:getCorrelationId
MethodInvocation:build
MethodInvocation:getJoinType
MethodInvocation:setNewForOldRel
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[Collect rel]
MethodInvocation:rewriteGeneric
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[Uncollect rel]
MethodInvocation:rewriteGeneric
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[LogicalIntersect rel]
MethodInvocation:rewriteGeneric
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[LogicalMinus rel]
MethodInvocation:rewriteGeneric
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[LogicalUnion rel]
MethodInvocation:rewriteGeneric
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[LogicalValues rel]
MethodInvocation:rewriteGeneric
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[LogicalTableFunctionScan rel]
MethodInvocation:rewriteGeneric
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[Sample rel]
MethodInvocation:rewriteGeneric
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[LogicalProject rel]
MethodInvocation:getProjects
MethodInvocation:getFieldNames
MethodInvocation:getRowType
MethodInvocation:flattenProjections
MethodInvocation:getNewForOldRel
MethodInvocation:getInput
MethodInvocation:left
MethodInvocation:right
MethodInvocation:build
MethodInvocation:hints
MethodInvocation:projectNamed
MethodInvocation:push
MethodInvocation:getHints
MethodInvocation:setNewForOldRel
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[LogicalCalc rel]
MethodInvocation:getNewForOldRel
MethodInvocation:getInput
MethodInvocation:getCluster
MethodInvocation:getRowType
MethodInvocation:getRexBuilder
MethodInvocation:getProgram
MethodInvocation:getExprList
MethodInvocation:registerInput
MethodInvocation:accept
MethodInvocation:getFieldNames
MethodInvocation:getRowType
MethodInvocation:flattenProjections
MethodInvocation:getProjectList
MethodInvocation:addProject
MethodInvocation:getCondition
MethodInvocation:getNewFieldForOldInput
MethodInvocation:getIndex
MethodInvocation:addCondition
MethodInvocation:getProgram
MethodInvocation:create
MethodInvocation:setNewForOldRel
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[SelfFlatteningRel rel]
MethodInvocation:flattenRel
Method-name:rewriteGeneric
Method-returnType:void
Method-parameters:[RelNode rel]
MethodInvocation:copy
MethodInvocation:getTraitSet
MethodInvocation:getInputs
MethodInvocation:getInputs
MethodInvocation:size
MethodInvocation:replaceInput
MethodInvocation:getNewForOldRel
MethodInvocation:get
MethodInvocation:setNewForOldRel
Method-name:flattenProjections
Method-returnType:void
Method-parameters:[RewriteRexShuttle shuttle, List<? extends RexNode> exps, List<String> fieldNames, String prefix, List<Pair<RexNode,String>> flattenedExps]
MethodInvocation:size
MethodInvocation:get
MethodInvocation:extractName
MethodInvocation:flattenProjection
Method-name:extractName
Method-returnType:String
Method-parameters:[List<String> fieldNames, String prefix, int i]
MethodInvocation:get
MethodInvocation:get
MethodInvocation:equals
Method-name:flattenProjection
Method-returnType:void
Method-parameters:[RewriteRexShuttle shuttle, RexNode exp, String fieldName, List<Pair<RexNode,String>> flattenedExps]
MethodInvocation:isStruct
MethodInvocation:getType
MethodInvocation:getIndex
MethodInvocation:postFlattenSize
MethodInvocation:getType
MethodInvocation:getNewFieldForOldInput
MethodInvocation:add
MethodInvocation:of
MethodInvocation:isConstructor
MethodInvocation:isA
MethodInvocation:isA
MethodInvocation:isNullLiteral
MethodInvocation:get
MethodInvocation:flattenNullLiteral
MethodInvocation:getType
MethodInvocation:flattenProjections
MethodInvocation:getOperands
MethodInvocation:nCopies
MethodInvocation:size
MethodInvocation:getOperands
MethodInvocation:getOperands
MethodInvocation:getOperator
MethodInvocation:isStruct
MethodInvocation:getType
MethodInvocation:get
MethodInvocation:isA
MethodInvocation:get
MethodInvocation:inCharFamily
MethodInvocation:getType
MethodInvocation:get
MethodInvocation:getValueAs
MethodInvocation:get
MethodInvocation:get
MethodInvocation:getFieldList
MethodInvocation:getType
MethodInvocation:equalsIgnoreCase
MethodInvocation:getName
MethodInvocation:getIndex
MethodInvocation:postFlattenSize
MethodInvocation:getType
MethodInvocation:getNewFieldForOldInput
MethodInvocation:makeInputRef
MethodInvocation:add
MethodInvocation:of
MethodInvocation:postFlattenSize
MethodInvocation:getType
MethodInvocation:flattenProjection
MethodInvocation:getNewInnerOrdinal
MethodInvocation:postFlattenSize
MethodInvocation:getType
MethodInvocation:add
MethodInvocation:get
MethodInvocation:collect
MethodInvocation:map
MethodInvocation:stream
MethodInvocation:accept
MethodInvocation:toList
MethodInvocation:makeCall
MethodInvocation:getType
MethodInvocation:flattenResultTypeOfRexCall
MethodInvocation:needToImplement
MethodInvocation:add
MethodInvocation:of
MethodInvocation:accept
Method-name:flattenResultTypeOfRexCall
Method-returnType:void
Method-parameters:[RexNode newExp, String fieldName, List<Pair<RexNode,String>> flattenedExps]
MethodInvocation:getFieldList
MethodInvocation:getType
MethodInvocation:makeFieldAccess
MethodInvocation:getIndex
MethodInvocation:isStruct
MethodInvocation:getType
MethodInvocation:flattenResultTypeOfRexCall
MethodInvocation:add
MethodInvocation:of
Method-name:flattenNullLiteral
Method-returnType:void
Method-parameters:[RelDataType type, List<Pair<RexNode,String>> flattenedExps]
MethodInvocation:flattenRecordType
MethodInvocation:getTypeFactory
MethodInvocation:getFieldList
MethodInvocation:add
MethodInvocation:of
MethodInvocation:makeNullLiteral
MethodInvocation:getType
MethodInvocation:getName
Method-name:isConstructor
Method-returnType:boolean
Method-parameters:[RexNode rexNode]
MethodInvocation:equalsIgnoreCase
MethodInvocation:getName
MethodInvocation:getOperator
MethodInvocation:isA
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[TableScan rel]
MethodInvocation:toRel
MethodInvocation:getTable
MethodInvocation:isFlat
MethodInvocation:getRowType
MethodInvocation:coverNewRelByFlatteningProjection
MethodInvocation:copyRelHints
MethodInvocation:setNewForOldRel
Method-name:coverNewRelByFlatteningProjection
Method-returnType:RelNode
Method-parameters:[RelNode rel, RelNode newRel]
MethodInvocation:makeRangeReference
MethodInvocation:getFieldList
MethodInvocation:getRowType
MethodInvocation:flattenInputs
MethodInvocation:left
MethodInvocation:right
MethodInvocation:build
MethodInvocation:projectNamed
MethodInvocation:push
MethodInvocation:copyRelHints
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[LogicalSnapshot rel]
MethodInvocation:copy
MethodInvocation:getTraitSet
MethodInvocation:getNewForOldRel
MethodInvocation:getInput
MethodInvocation:accept
MethodInvocation:getPeriod
MethodInvocation:setNewForOldRel
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[LogicalDelta rel]
MethodInvocation:rewriteGeneric
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[LogicalChi rel]
MethodInvocation:rewriteGeneric
Method-name:rewriteRel
Method-returnType:void
Method-parameters:[LogicalMatch rel]
MethodInvocation:rewriteGeneric
Method-name:flattenInputs
Method-returnType:void
Method-parameters:[List<RelDataTypeField> fieldList, RexNode prefix, List<Pair<RexNode,String>> flattenedExpList]
MethodInvocation:makeFieldAccess
MethodInvocation:getIndex
MethodInvocation:isStruct
MethodInvocation:getType
MethodInvocation:getFieldList
MethodInvocation:getType
MethodInvocation:flattenInputs
MethodInvocation:add
MethodInvocation:of
MethodInvocation:getName
Method-name:flattenRel
Method-returnType:void
Method-parameters:[RelStructuredTypeFlattener flattener]
Class:RewriteRelVisitor
Field:dispatcher
MethodInvocation:createDispatcher
Method-name:visit
Method-returnType:void
Method-parameters:[RelNode p, int ordinal, RelNode parent]
MethodInvocation:invokeVisitor
MethodInvocation:size
MethodInvocation:getInputs
MethodInvocation:rewriteGeneric
MethodInvocation:getName
MethodInvocation:getClass
Class:RewriteRexShuttle
Method-name:visitInputRef
Method-returnType:RexNode
Method-parameters:[RexInputRef input]
MethodInvocation:getIndex
MethodInvocation:getNewFieldForOldInput
MethodInvocation:orElseThrow
MethodInvocation:findFirst
MethodInvocation:skip
MethodInvocation:flatMap
MethodInvocation:stream
MethodInvocation:getInputs
MethodInvocation:stream
MethodInvocation:getFieldList
MethodInvocation:getRowType
MethodInvocation:isStruct
MethodInvocation:getType
MethodInvocation:restructureFields
MethodInvocation:getType
MethodInvocation:makeCall
MethodInvocation:getType
MethodInvocation:removeDistinct
Method-name:removeDistinct
Method-returnType:RelDataType
Method-parameters:[RelDataType type]
MethodInvocation:getSqlTypeName
MethodInvocation:getType
MethodInvocation:get
MethodInvocation:getFieldList
Method-name:visitFieldAccess
Method-returnType:RexNode
Method-parameters:[RexFieldAccess fieldAccess]
MethodInvocation:getReferenceExpr
MethodInvocation:getIndex
MethodInvocation:getField
MethodInvocation:push
MethodInvocation:getPostFlatteningOrdinal
MethodInvocation:getType
MethodInvocation:noFlatteningForInput
MethodInvocation:getIndex
MethodInvocation:getNewFieldForOldInput
MethodInvocation:getIndex
MethodInvocation:getKey
MethodInvocation:removeDistinct
MethodInvocation:getValue
MethodInvocation:flattenRecordType
MethodInvocation:getTypeFactory
MethodInvocation:getType
MethodInvocation:makeCorrel
FieldAccess:id
MethodInvocation:makeFieldAccess
MethodInvocation:visitCall
MethodInvocation:makeFieldAccess
MethodInvocation:needToImplement
Method-name:visitCall
Method-returnType:RexNode
Method-parameters:[RexCall rexCall]
MethodInvocation:isA
MethodInvocation:accept
MethodInvocation:get
MethodInvocation:getOperands
MethodInvocation:removeDistinct
MethodInvocation:getType
MethodInvocation:makeCast
MethodInvocation:isStruct
MethodInvocation:getType
MethodInvocation:get
MethodInvocation:isA
MethodInvocation:get
MethodInvocation:inCharFamily
MethodInvocation:getType
MethodInvocation:get
MethodInvocation:get
MethodInvocation:getValueAs
MethodInvocation:get
MethodInvocation:getIndex
MethodInvocation:getNewInnerOrdinal
MethodInvocation:getNewFieldForOldInput
MethodInvocation:makeInputRef
MethodInvocation:accept
MethodInvocation:getIndex
MethodInvocation:getNewInnerOrdinal
MethodInvocation:getNewInputFieldByNewOrdinal
MethodInvocation:makeInputRef
MethodInvocation:getType
MethodInvocation:isA
MethodInvocation:get
MethodInvocation:getOperands
MethodInvocation:isStruct
MethodInvocation:getType
MethodInvocation:flattenComparison
MethodInvocation:getOperator
MethodInvocation:getOperands
Method-name:visitSubQuery
Method-returnType:RexNode
Method-parameters:[RexSubQuery subQuery]
MethodInvocation:rewrite
MethodInvocation:clone
Method-name:flattenComparison
Method-returnType:RexNode
Method-parameters:[RexBuilder rexBuilder, SqlOperator op, List<RexNode> exprs]
MethodInvocation:flattenProjections
MethodInvocation:size
MethodInvocation:getKind
MethodInvocation:getKind
MethodInvocation:needToImplement
MethodInvocation:makeCall
FieldAccess:left
MethodInvocation:get
FieldAccess:left
MethodInvocation:get
MethodInvocation:makeCall
MethodInvocation:makeCall
Method-name:getNewInnerOrdinal
Method-returnType:int
Method-parameters:[RexNode firstOp, String literalString]
MethodInvocation:getFieldList
MethodInvocation:getType
MethodInvocation:equalsIgnoreCase
MethodInvocation:getName
MethodInvocation:postFlattenSize
MethodInvocation:getType
